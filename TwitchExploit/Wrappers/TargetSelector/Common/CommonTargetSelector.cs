// --------------------------------------------------------------------------------------------------------------------
// <copyright file="CommonTargetSelector.cs" company="TwitchExploit">
//     Copyright (c) TwitchExploit. All rights reserved.
// </copyright>
// --------------------------------------------------------------------------------------------------------------------
namespace TwitchExploit.Wrappers.TargetSelector.Common
{
    using System;
    using System.Security;

    using LeagueSharp;
    using LeagueSharp.Common;

    [SecuritySafeCritical]
    [ExportWrapper(typeof(ITargetSelector), TargetFramework.Common)]
    public class CommonTargetSelector : TargetSelectorBase
    {
        [SecuritySafeCritical]
        public override void Activate()
        {
            TargetSelector.Initialize();
        }

        [SecuritySafeCritical]
        public override void Deactivate()
        {
            TargetSelector.Shutdown();
        }

        [SecuritySafeCritical]
        public override AttackableUnit GetSelectedTarget(float range, DamageType type)
        {
            return TargetSelector.SelectedTarget;
        }

        [SecuritySafeCritical]
        public override AttackableUnit GetTarget(float range, DamageType type)
        {
            switch (type)
            {
                case DamageType.Physical:
                    return TargetSelector.GetTarget(range, TargetSelector.DamageType.Physical);

                case DamageType.Magical:
                    return TargetSelector.GetTarget(range, TargetSelector.DamageType.Magical);

                case DamageType.True:
                    return TargetSelector.GetTarget(range, TargetSelector.DamageType.True);

                default:
                    throw new NotSupportedException($"{type}");
            }
        }
    }
}